package com.github.archturion64.thirdeye.services;

import com.github.archturion64.thirdeye.domains.Vulnerability;
import com.github.archturion64.thirdeye.repositories.VulnerabilityRepository;
import lombok.AllArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@AllArgsConstructor
public class VulnerabilityService {

    private final VulnerabilityRepository vulnerabilityRepository;

    public List<Vulnerability> listAll(){
        return vulnerabilityRepository.findAll();
    }

    public void save(Vulnerability vulnerability){
        vulnerabilityRepository.save(vulnerability);
    }

    public Vulnerability get(Long id) throws IllegalArgumentException {
        return vulnerabilityRepository.findById(id)
                .orElseThrow(() ->
                        new IllegalArgumentException(String.format("Unknown id %s", id)));
    }

    public void delete(Long id){
        vulnerabilityRepository.deleteById(id);
    }

    public void edit(Vulnerability vulnerability) {
        vulnerabilityRepository.save(vulnerability);
    }
}
