package com.github.archturion64.thirdeye.controllers;

import com.github.archturion64.thirdeye.domains.Vulnerability;
import com.github.archturion64.thirdeye.services.VulnerabilityService;
import lombok.AllArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/v1/vulnerabilities")
@AllArgsConstructor
public class VulnerabilityRestController {
    private final VulnerabilityService vulnerabilityService;


    @GetMapping("/get/all")
    public List<Vulnerability> getAllVulnerabilities(){
        return vulnerabilityService.listAll();
    }

    @PostMapping("/add")
    public String addVulnerability(@RequestBody Vulnerability vulnerability) {
        vulnerabilityService.save(vulnerability);
        return "vulnerability added";
    }

    @PutMapping("/edit")
    public String editVulnerability(@RequestBody Vulnerability vulnerability) {
        vulnerabilityService.edit(vulnerability);
        return "vulnerability modified";
    }

    @PutMapping("/delete/{id}")
    public String deleteVulnerability(@PathVariable(name="id") long id) {
        vulnerabilityService.delete(id);
        return "vulnerability deleted";
    }
}
