package com.github.archturion64.thirdeye.domains;

import lombok.Data;
import lombok.NoArgsConstructor;
import javax.validation.constraints.Pattern;

import javax.persistence.*;

@Data
@NoArgsConstructor
@Entity
@Table(name = "vulnerability")
public class Vulnerability {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(
            name = "id",
            updatable = false)
    private Long id;

    @Column(
            columnDefinition="TEXT",
            nullable = false,
            unique = true)
    @Pattern(regexp="CVE-\\d{4}-\\d{4,7}",message="Invalid CVE number")
    private String cveIdentifier;

    @Column(
            columnDefinition="TEXT",
            nullable = false)
    private String name;

    @Lob
    private String description;

    @Enumerated(EnumType.STRING)
    @Column(
            name = "severity"
    )
    private Severity severity;

    public Vulnerability(String cveIdentifier, String name, String description, Severity severity) {
        this.cveIdentifier = cveIdentifier;
        this.name = name;
        this.description = description;
        this.severity = severity;
    }
}
